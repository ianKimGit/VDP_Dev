CREATE OR REPLACE VIEW iv_sales_by_store FOLDER = '/1. connectivity/2. base views' AS SELECT bv_store_sales_fact.date_key AS date_key, bv_store_sales_fact.product_key AS product_key, bv_store_sales_fact.product_version AS product_version, bv_store_sales_fact.promotion_key AS promotion_key, bv_store_sales_fact.customer_key AS customer_key, bv_store_sales_fact.employee_key AS employee_key, bv_store_sales_fact.pos_transaction_number AS pos_transaction_number, bv_store_sales_fact.sales_quantity AS sales_quantity, bv_store_sales_fact.sales_dollar_amount AS sales_dollar_amount, bv_store_sales_fact.cost_dollar_amount AS cost_dollar_amount, bv_store_sales_fact.gross_profit_dollar_amount AS gross_profit_dollar_amount, bv_store_sales_fact.transaction_type AS transaction_type, bv_store_sales_fact.transaction_time AS transaction_time, bv_store_sales_fact.tender_type AS tender_type, bv_o_store_dimension.store_key AS store_key, bv_o_store_dimension.store_name AS store_name, bv_o_store_dimension.store_number AS store_number, bv_o_store_dimension.store_address AS store_address, bv_o_store_dimension.store_city AS store_city, bv_o_store_dimension.store_state AS store_state, bv_o_store_dimension.store_region AS store_region, bv_o_store_dimension.floor_plan_type AS floor_plan_type, bv_o_store_dimension.photo_processing_type AS photo_processing_type, bv_o_store_dimension.financial_service_type AS financial_service_type, bv_o_store_dimension.selling_square_footage AS selling_square_footage, bv_o_store_dimension.total_square_footage AS total_square_footage, bv_o_store_dimension.first_open_date AS first_open_date, bv_o_store_dimension.last_remodel_date AS last_remodel_date, bv_o_store_dimension.number_of_employees AS number_of_employees, bv_o_store_dimension.annual_shrinkage AS annual_shrinkage, bv_o_store_dimension.foot_traffic AS foot_traffic, bv_o_store_dimension.monthly_rent_cost AS monthly_rent_cost FROM bv_store_sales_fact AS bv_store_sales_fact INNER JOIN bv_o_store_dimension AS bv_o_store_dimension ON bv_store_sales_fact.store_key = bv_o_store_dimension.store_key ;

ALTER VIEW iv_sales_by_store
 LAYOUT (bv_store_sales_fact = [20, 20, 200, 200], bv_o_store_dimension = [492, 42, 200, 200]);

